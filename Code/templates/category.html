<!doctype html>
<html lang="en">
  <head>
    <title>G-Grocery|Home:</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='fix.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='button_style1.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='button_style2.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='button_style3.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='search_box.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
  </head>
  <body>
   <section class="vh-100">
      <div class="container-fluid" style="background-color: #f0f0f0;">
        <div class="row-sm-1">
          <div class="col-xs-12 text-black">
            <div class="d-flex align-items-center justify-content-between px-2 ms-xl-4" style="height: 70px;">
                <div class="d-flex align-items-center justify-content-between">
                    <span class="h3 fw-bold mb-0 px-2" style="order: 0;"><a href="/user={{usr}}" style="color: black; text-decoration: none;">G-Grocery</a></span>
                </div>
                {% if admin == true %}
                <button class="btn btn-info btn-lg fw-bold" id="management" type="button" style="background-color: #b1eb3d; outline: #b1eb3d; border-color: #b1eb3d; font-family: Cursive;" onfocus="this.style.boxShadow = '0 0 0 5px rgba(177, 235, 61, 0.150)'" onblur="this.style.boxShadow = '0 0 0 0 rgba(177, 235, 61, 0.075)'" onmouseover="this.style.backgroundColor = '#88eb3d'" onmouseout="this.style.backgroundColor = '#b1eb3d'">Store management <i class="fa-solid fa-book-open"></i></button>
                {% endif %}
                {% if admin == false %}
                <button class="btn btn-info btn-lg fw-bold" id="cart" type="button" style="background-color: #b1eb3d; outline: #b1eb3d; border-color: #b1eb3d; font-family: Cursive;" onfocus="this.style.boxShadow = '0 0 0 5px rgba(177, 235, 61, 0.150)'" onblur="this.style.boxShadow = '0 0 0 0 rgba(177, 235, 61, 0.075)'" onmouseover="this.style.backgroundColor = '#88eb3d'" onmouseout="this.style.backgroundColor = '#b1eb3d'">Cart <i class="fa-solid fa-cart-shopping"></i></button>
                {% endif %}
                <div class="d-flex align-items-center">
                  <span class="h3 fw-bold mb-0 px-2" ><a href="/profile={{usr}}" style="color: black; text-decoration: none;">{{usr}}</a></span>
                  <button class="btn btn-info btn-lg" id="LogoutButton" type="button" style="background-color: #d3eb3d; outline: #d3eb3d; border-color: #d3eb3d; font-family: Cursive;" onfocus="this.style.boxShadow = '0 0 0 5px rgba(211, 235, 61, 0.150)'" onblur="this.style.boxShadow = '0 0 0 0 rgba(211, 235, 61, 0.075)'" onmouseover="this.style.backgroundColor = '#b1eb3d'" onmouseout="this.style.backgroundColor = '#d3eb3d'">Logout</button>
                </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container-fluid" style="background-color: #d6d4d4;">
        <div class="row">
          <div class="col-sm-12 col-xs-12 text-black">

            <div class="d-flex align-items-center justify-content-start px-2 ms-xl-4" style="height: 20px;">
                <span class="h7 mb-0 px-2 text-black " style="order: 0;"><a href="/user={{usr}}" style="color: black; text-decoration: none;">Home</a> </span>
                <span class="h7 mb-0 px-2 text-black pb-1">|</span>
                <span class="h7 mb-0 px-2 text-black"><a href="/user={{usr}}/Categories" style="color: black; text-decoration: none;">Categories</a> </span>
                <span class="h7 mb-0 px-2 text-black pb-1">|</span>
            </div>

          </div>
        </div>
      </div>

      <div class="container-fluid">
        <div class="row">
          <!-- Search panel -->
          <div class="col-sm-2 col-xs-12 text-black" style="background-color: #ebebeb;">

            <div class="d-flex px-1 pb-1 pt-1 ms-xl-xs-0 " style="height: 540px; border-right: 3px ridge #5c5c5c; flex-direction: column;">
              <!-- Add filter options here -->
              <div class="d-flex px-1 pb-1 pt-1 ms-xl-xs-0 justify-content-between align-items-center" style="height: 10%; width: 100%; border-bottom: 2px solid #bfbdbd; flex-direction: row; overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1;">
                <form action="/user={{usr}}" method="POST">
                  <div class="d-flex justify-content-between align-items-center" style="flex-direction: row;">
                    <input class="search-box search-error form-control form-control-lg" type="search" id="search" name="search" placeholder="Search..." style="height:90%; width:80%;" required />
                    <button class="btn button-style2 pt-2" id="search" type="Submit" style="height: 100%; width: 18%;"><i class="fa-solid fa-magnifying-glass"></i></button>
                  </div>
                </form>
              </div>
            </div>

          </div>

          <!-- Main page -->
          <div class="col-sm-9 col-xs-12 text-black" id="Parent-class">
            <div class="d-flex align-items-end  px-1 pb-1 pt-1 ms-xl-xs-0 " style="height: 540px; flex-direction: column;">
                
                <!-- Title banner -->  <!-- background-color: #d4d4d4;-->
                <div class="d-flex align-items-start px-1 pb-1 pt-1 ms-xl-xs-0 " style="height: 8%; width: 100%; border-bottom: 2px solid #bfbdbd; flex-direction: column;">
                  <span class="px-2 text-start fs-lg-5 fs-md-4 fs-sm-5 fs-xl-6" style="font-family: cursive; font-weight:bold;"> {{cat}}:</span>
                </div>

                <div class="d-flex flex-wrap align-items-start justify-content-start ms-xl-xs-0 pt-2" style="width:100%; height:100%;">
                  {% if r_txt == None %}
                    {% for product in plist %}
                      {% if product[4] > 0 %}
                        <!-- Content  -->  <!-- background-color: #f0f0f0; background-color: #e3e3e3;-->
                        <div class="d-flex px-3 pt-2 pb-3" style="width:264px;height:264px;">
                          <div class="d-flex align-items-center justify-content-center pb-1" style="border-radius: 18px; border: 1px solid #454444;border-bottom: 3px solid #454444; background-color: #e3e3e3;width:100%;height:100%; font-family: cursive; font-weight:normal; flex-direction: column;">
                            <div class="d-flex align-items-center justify-content-center text-center pt-1 pb-1 fs-5" style="overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1; max-height: 18%; max-width: 70%;height: 16%;">
                              <span>{{product[1]}}</span>
                            </div>
                            <div class="d-flex align-items-between justify-content-center text-center border border-dark mt-3 pt-1 pb-2 px-3 fs-5" style="overflow: hidden; word-wrap: break-word; font-family: cursive; background-color: white;height: 68%; width: 85%; border-radius: 18px; flex-direction: column; ">
                              <form id="form_{{product[0]}}" action="/user={{usr}}/add_cart={{product[0]}},{{product[1]}}" method="POST">
                                <input type="hidden" name="url" value="/user={{usr}}/Category={{cat}}">
                              </form>
                              <div class="d-flex align-items-start justify-content-between mb-1" style="flex-direction:column;">
                                {% if product[6] %}
                                 <div class="d-flex" style="flex-direction: column">
                                  <span class="" style="font-size: 16px; color: red; text-align: left; text-decoration: line-through;"> {{product[3]}} {{product[2]}} </span>
                                  <span style="text-decoration: none;"> {{product[3] - product[3]*product[6]/100}} {{product[2]}}</span>                             
                                 </div>
                                 <span>{{product[6]}}% discount</span>
                                {% else %}
                                  <span> {{product[3]}} {{product[2]}}</span>
                                {% endif %}
                              </div>
                              <div class="d-flex justify-content-between" style="height: 80%; width: 100%; align-items: flex-end;">
                                <div class="d-flex justify-content-between" style="height: 86%; width: 100%; align-items: flex-end;">
                                  <div class="d-flex align-items-center px-1" style="height: 88%; width: 50%; overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1;">
                                    <button class="btn btn-lg button-style2 fs-xl-5 fs-lg-6 fs-xs-7 buy" style="overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1;" id="Buy_{{product[1]}}" type="button" style="height: 80%; width: 100%;" product_ID='{{product[0]}}' product_Name="{{product[1]}}">Buy</button>
                                  </div>
                                  <div class="d-flex align-items-center px-1" style="background-color:#ffffff; height: 88%; width: 50%; overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1;">
                                    <button class="btn btn-lg button-style1 fs-xl-5 fs-lg-6 fs-xs-7 cart" style="overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1;" id="to_cart" type="submit" form="form_{{product[0]}}" style="height: 80%; width: 100%;" product_ID='{{product[0]}}' product_Name="{{product[1]}}"><i class="fa-solid fa-cart-shopping cart" product_ID='{{product[0]}}' product_Name="{{product[1]}}"></i></button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      {% else %}
                        <div class="d-flex px-3 pt-2 pb-3" style="width:264px;height:264px;">
                          <div class="d-flex align-items-center justify-content-center pb-1" style="border-radius: 18px; border: 1px solid #454444;border-bottom: 3px solid #454444; background-color: #e3e3e3;width:100%;height:100%; font-family: cursive; font-weight:normal; flex-direction: column;">
                            <div class="d-flex align-items-center justify-content-center text-center pt-1 pb-1 fs-5" style="overflow: hidden; word-wrap: break-word; font-family: cursive; line-height: 1; max-height: 18%; max-width: 70%;height: 16%;">
                              <span>{{product[1]}}</span>
                            </div>
                            <div class="d-flex align-items-between justify-content-center text-center border border-dark mt-3 pt-1 pb-2 px-1 fs-5" style="overflow: hidden; word-wrap: break-word; font-family: cursive; background-color: white;height: 68%; width: 85%; border-radius: 18px; flex-direction: column; ">
                              <div class="d-flex align-items-start justify-content-between mb-1" style="flex-direction:column;">
                                {% if product[6] %}
                                 <div class="d-flex" style="flex-direction: column">
                                  <span class="" style="font-size: 16px; color: red; text-align: left; text-decoration: line-through;"> {{product[3]}} {{product[2]}} </span>
                                  <span style="text-decoration: none;"> {{product[3] - product[3]*product[6]/100}} {{product[2]}}</span>                             
                                 </div>
                                 <span>{{product[6]}}% discount</span>
                                {% else %}
                                  <span> {{product[3]}} {{product[2]}}</span>
                                {% endif %}
                                <span style="color:red;">OUT OF STOCK</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      {% endif %}
                    {% endfor %}
                  {% else %}
                    <span style="font-family: cursive; font-weight:normal;">{{r_txt}}</span>
                  {% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>

      <script>
        const button = document.getElementById('LogoutButton');
        button.addEventListener('click', function() {
            window.location.href = '/logout';
        });

        {% if admin == true %}
          const storeM_button = document.getElementById('management');
          storeM_button.addEventListener('click', function() {
              window.location.href = '/user={{usr}}/management';
          });
        {% else %}
          const cart_button = document.getElementById('cart');
          cart_button.addEventListener('click', function() {
              window.location.href = '/user={{usr}}/cart=Default';
          });
        {% endif %}
    </script>
    <script>
          var parentclass = document.getElementById('Parent-class')
          parentclass.addEventListener('click',function(event){
            console.log(event.target.classList)
            if (event.target.classList.contains('cat-tag')){
              var cat_Name =  event.target.getAttribute('category')
              window.location.href = '/user={{usr}}/Category=' + cat_Name;
            }
            else if(event.target.classList.contains('buy')){
              var prod_Name =  event.target.getAttribute('product_Name')
              var prod_ID =  event.target.getAttribute('product_ID')
              window.location.href = '/user={{usr}}/Buy=' + prod_ID+","+prod_Name;
            }
            });
      </script>
  </body>
</html>